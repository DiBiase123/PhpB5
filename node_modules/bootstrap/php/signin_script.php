<?php session_start();
//verification formulaire
if 
    (
        !isset($_POST['email'])
        || !isset($_POST['password'])
    ) 
    {
        echo ('Il fau un email et un password pou soumettre le formulaire. ');
        return;
    }

    $email =  $_POST['email'];
    $username = $_POST['username'];
    $password = $_POST['password'];

    echo ($email);
    echo ($username);
    echo ( $password );

try 
{
    $db = new PDO('mysql:host=localhost;dbname=chambre;charset=utf8', 'xaraton', 'micio1917!');
    // Si tout va bien, on peut continuer
    // Ecriture de la requête
    $sqlQuery = 'INSERT INTO users(email, username, password, age ) VALUES (:email, :username, :password, :age)';

    // Préparation
    $insertRecipe = $db->prepare($sqlQuery);

    // Exécution ! La recette est maintenant en base de données
    $insertRecipe->execute([
        'email' =>  $_POST['email'],
        'username' =>  $_POST['username'],
        'password' => $_POST['password'],
        'age' => 0,
    ]);

    echo ('Bonjour et Bienvenue sur le site : ' . $_SESSION['session_user']);
    header('Refresh: 5; URL=../html/login.php'); 


} 
catch (Exception $e) 
{
    die('Erreur : ' . $e->getMessage());
}


?>



